From ccbe454de3d735534c2b074fcd84f8b7e3bae19f Mon Sep 17 00:00:00 2001
From: Hsieh-Tseng Shen <woodrow.shen@gmail.com>
Date: Fri, 2 Apr 2021 14:09:23 +0800
Subject: [PATCH 2/2] Add efivar into dependency of uefi_capsule

---
 meson.build                      | 1 +
 plugins/uefi-capsule/meson.build | 3 +++
 2 files changed, 4 insertions(+)

diff --git a/meson.build b/meson.build
index 86e70573..903a4974 100644
--- a/meson.build
+++ b/meson.build
@@ -350,6 +350,7 @@ if build_standalone and get_option('plugin_uefi_capsule')
   fontconfig = cc.find_library('fontconfig')
   freetype = cc.find_library('freetype')
   efiboot = dependency('efiboot')
+  efivar = dependency('efivar')
   objcopy = find_program ('objcopy')
   readelf = find_program ('readelf')
   genpeimg = find_program ('genpeimg', required: false)
diff --git a/plugins/uefi-capsule/meson.build b/plugins/uefi-capsule/meson.build
index bab74ab9..2b209d45 100644
--- a/plugins/uefi-capsule/meson.build
+++ b/plugins/uefi-capsule/meson.build
@@ -38,6 +38,7 @@ shared_module('fu_plugin_uefi_capsule',
   c_args : cargs,
   dependencies : [
     plugin_deps,
+    efivar,
     efiboot,
     tpm2tss,
   ],
@@ -65,6 +66,7 @@ fwupdate = executable(
   ],
   dependencies : [
     plugin_deps,
+    efivar,
     efiboot,
     tpm2tss,
   ],
@@ -150,6 +152,7 @@ if get_option('tests')
     ],
     dependencies : [
       plugin_deps,
+      efivar,
       efiboot,
       tpm2tss,
     ],
-- 
2.25.1


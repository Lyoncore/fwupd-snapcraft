From e96e1b0826569f7155891b56bc3cac9e1c47b22a Mon Sep 17 00:00:00 2001
From: Hsieh-Tseng Shen <woodrow.shen@gmail.com>
Date: Mon, 19 Jul 2021 14:07:39 +0800
Subject: [PATCH 2/2] Add efivar into dependency of uefi_capsule

Signed-off-by: Hsieh-Tseng Shen <woodrow.shen@gmail.com>
---
 meson.build                      | 1 +
 plugins/uefi-capsule/meson.build | 3 +++
 2 files changed, 4 insertions(+)

diff --git a/meson.build b/meson.build
index 805dbe10..9286e770 100644
--- a/meson.build
+++ b/meson.build
@@ -350,6 +350,7 @@ if build_standalone and get_option('plugin_uefi_capsule')
   fontconfig = cc.find_library('fontconfig')
   freetype = cc.find_library('freetype')
   efiboot = dependency('efiboot')
+  efivar = dependency('efivar')
   objcopy = find_program ('objcopy')
   genpeimg = find_program ('genpeimg', required: false)
 
diff --git a/plugins/uefi-capsule/meson.build b/plugins/uefi-capsule/meson.build
index d92eddad..31afe577 100644
--- a/plugins/uefi-capsule/meson.build
+++ b/plugins/uefi-capsule/meson.build
@@ -44,6 +44,7 @@ shared_module('fu_plugin_uefi_capsule',
   c_args : cargs,
   dependencies : [
     plugin_deps,
+    efivar,
     efiboot,
     tpm2tss,
   ],
@@ -71,6 +72,7 @@ fwupdate = executable(
   ],
   dependencies : [
     plugin_deps,
+    efivar,
     efiboot,
     tpm2tss,
   ],
@@ -156,6 +158,7 @@ if get_option('tests')
     ],
     dependencies : [
       plugin_deps,
+      efivar,
       efiboot,
       tpm2tss,
     ],
-- 
2.25.1

